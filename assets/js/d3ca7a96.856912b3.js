"use strict";(self.webpackChunklangflow_docs=self.webpackChunklangflow_docs||[]).push([[265],{80454:(e,o,n)=>{n.r(o),n.d(o,{CH:()=>d,assets:()=>l,chCodeConfig:()=>h,contentTitle:()=>c,default:()=>f,frontMatter:()=>i,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"Develop/memory","title":"Memory management options","description":"Langflow provides flexible memory management options for storage and retrieval.","source":"@site/docs/Develop/memory.md","sourceDirName":"Develop","slug":"/memory","permalink":"/memory","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Memory management options","slug":"/memory"},"sidebar":"docs","previous":{"title":"Install custom dependencies","permalink":"/install-custom-dependencies"},"next":{"title":"Session ID","permalink":"/session-id"}}');var t=n(74848),s=n(28453),a=n(24754);const i={title:"Memory management options",slug:"/memory"},c=void 0,l={},d={annotations:a.hk,Code:a.Cy},h={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:!0,showCopyButton:!0,themeName:"github-dark"},m=[{value:"Local Langflow database tables",id:"local-langflow-database-tables",level:2},{value:"Store messages in local memory",id:"store-messages-in-local-memory",level:2},{value:"Configure external memory",id:"configure-external-memory",level:2},{value:"Configure the external database connection",id:"configure-the-external-database-connection",level:2},{value:"Configure cache memory",id:"configure-cache-memory",level:2}];function g(e){const o={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return d||u("CH",!1),d.Code||u("CH.Code",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="github-dark"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #c9d1d9;--ch-t-background: #0d1117;--ch-t-lighter-inlineBackground: #0d1117e6;--ch-t-editor-background: #0d1117;--ch-t-editor-foreground: #c9d1d9;--ch-t-editor-lineHighlightBackground: #6e76811a;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #1f6feb;--ch-t-tab-activeBackground: #0d1117;--ch-t-tab-activeForeground: #c9d1d9;--ch-t-tab-inactiveBackground: #010409;--ch-t-tab-inactiveForeground: #8b949e;--ch-t-tab-border: #30363d;--ch-t-tab-activeBorder: #0d1117;--ch-t-editorGroup-border: #30363d;--ch-t-editorGroupHeader-tabsBackground: #010409;--ch-t-editorLineNumber-foreground: #6e7681;--ch-t-input-background: #0d1117;--ch-t-input-foreground: #c9d1d9;--ch-t-input-border: #30363d;--ch-t-icon-foreground: #8b949e;--ch-t-sideBar-background: #010409;--ch-t-sideBar-foreground: #c9d1d9;--ch-t-sideBar-border: #30363d;--ch-t-list-activeSelectionBackground: #6e768166;--ch-t-list-activeSelectionForeground: #c9d1d9;--ch-t-list-hoverBackground: #6e76811a;--ch-t-list-hoverForeground: #c9d1d9; }'}}),"\n",(0,t.jsx)(o.p,{children:"Langflow provides flexible memory management options for storage and retrieval."}),"\n",(0,t.jsx)(o.p,{children:"This page details the following memory configuration options in Langflow."}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#local-langflow-database-tables",children:"Local Langflow database tables"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#store-messages-in-local-memory",children:"Store messages in local memory"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#configure-external-memory",children:"Configure external memory"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#configure-the-external-database-connection",children:"Configure the external database connection"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.a,{href:"#configure-cache-memory",children:"Configure cache memory"})}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"local-langflow-database-tables",children:"Local Langflow database tables"}),"\n",(0,t.jsxs)(o.p,{children:["The default storage option in Langflow is a ",(0,t.jsx)(o.a,{href:"https://www.sqlite.org/",children:"SQLite"})," database stored in your system's cache directory:"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["Linux/WSL: ",(0,t.jsx)(o.code,{children:"~/.cache/langflow/langflow.db"})]}),"\n",(0,t.jsxs)(o.li,{children:["macOS: ",(0,t.jsx)(o.code,{children:"/Users/<username>/Library/Caches/langflow/langflow.db"})]}),"\n",(0,t.jsxs)(o.li,{children:["Windows: ",(0,t.jsx)(o.code,{children:"%LOCALAPPDATA%\\langflow\\langflow\\Cache\\langflow.db"})]}),"\n"]}),"\n",(0,t.jsxs)(o.p,{children:["The following tables are stored in ",(0,t.jsx)(o.code,{children:"langflow.db"}),":"]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"User"})," - Stores user account information including credentials, permissions, and profiles. For more information, see ",(0,t.jsx)(o.a,{href:"/configuration-authentication",children:"Authentication"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"Flow"})," - Contains flow configurations. For more information, see ",(0,t.jsx)(o.a,{href:"/concepts-flows",children:"Build flows"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"Message"})," - Stores chat messages and interactions that occur between components. For more information, see ",(0,t.jsx)(o.a,{href:"/concepts-objects#message-object",children:"Message objects"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"Transaction"})," - Records execution history and results of flow runs. This information is used for ",(0,t.jsx)(o.a,{href:"/logging",children:"logging"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"ApiKey"})," - Manages API authentication keys for users. For more information, see ",(0,t.jsx)(o.a,{href:"/configuration-api-keys",children:"API keys"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"Project"})," - Provides a structure for flow storage. For more information, see ",(0,t.jsx)(o.a,{href:"/concepts-flows#projects",children:"Projects"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"Variables"})," - Stores global encrypted values and credentials. For more information, see ",(0,t.jsx)(o.a,{href:"/configuration-global-variables",children:"Global variables"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["\u2022 ",(0,t.jsx)(o.strong,{children:"VertexBuild"})," - Tracks the build status of individual nodes within flows. For more information, see ",(0,t.jsx)(o.a,{href:"/concepts-playground",children:"Run a flow in the Playground"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["For more information, see the database models in the ",(0,t.jsx)(o.a,{href:"https://github.com/langflow-ai/langflow/tree/main/src/backend/base/langflow/services/database/models",children:"source code"}),"."]}),"\n",(0,t.jsx)(o.h2,{id:"store-messages-in-local-memory",children:"Store messages in local memory"}),"\n",(0,t.jsxs)(o.p,{children:["To store and retrieve messages in local Langflow memory, add a ",(0,t.jsx)(o.a,{href:"/components-helpers#message-history",children:"Message history"})," component to your flow."]}),"\n",(0,t.jsxs)(o.p,{children:["To store or retrieve chat messages from external memory, connect the ",(0,t.jsx)(o.strong,{children:"External memory"})," port of the ",(0,t.jsx)(o.strong,{children:"Message history"})," component to a ",(0,t.jsx)(o.strong,{children:"Memory"})," component.\nAn example flow looks like this:"]}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"Sample Flow storing Chat Memory in Redit",src:n(96841).A+"",width:"4000",height:"1768"})}),"\n",(0,t.jsx)(o.p,{children:"If external storage is connected to a memory helper component, no chat messages are stored in local Langflow memory."}),"\n",(0,t.jsxs)(o.p,{children:["For an example of using local chat memory, see the ",(0,t.jsx)(o.a,{href:"/memory-chatbot",children:"Memory chatbot"})," starter flow."]}),"\n",(0,t.jsx)(o.h2,{id:"configure-external-memory",children:"Configure external memory"}),"\n",(0,t.jsxs)(o.p,{children:["To replace the default Langflow SQLite database with another database, modify the ",(0,t.jsx)(o.code,{children:"LANGFLOW_DATABASE_URL"})," and start Langflow with this value."]}),"\n",(0,t.jsx)(d.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"LANGFLOW_DATABASE_URL=postgresql://user:password@localhost:5432/langflow",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,t.jsxs)(o.p,{children:["For an example, see ",(0,t.jsx)(o.a,{href:"/configuration-custom-database",children:"Configure an external PostgreSQL database"}),"."]}),"\n",(0,t.jsx)(o.h2,{id:"configure-the-external-database-connection",children:"Configure the external database connection"}),"\n",(0,t.jsx)(o.p,{children:"The following settings allow you to fine-tune your database connection pool and timeout settings:"}),"\n",(0,t.jsx)(d.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:'LANGFLOW_DB_CONNECTION_SETTINGS=\'{"pool_size": 20, "max_overflow": 30, "pool_timeout": 30, "pool_pre_ping": true, "pool_recycle": 1800, "echo": false}\'',props:{}}]},{tokens:[{content:"LANGFLOW_DB_CONNECT_TIMEOUT=20",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"pool_size"}),": Maximum number of database connections to keep in the pool (default: 20)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"max_overflow"}),": Maximum number of connections that can be created beyond the pool_size (default: 30)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"pool_timeout"}),": Number of seconds to wait before timing out on getting a connection from the pool (default: 30)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"pool_pre_ping"}),": If true, the pool tests connections for liveness upon each checkout (default: true)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"pool_recycle"}),": Number of seconds after which a connection is automatically recycled (default: 1800, or 30 minutes)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"echo"}),": If true, SQL queries are logged for debugging purposes (default: false)"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"LANGFLOW_DB_CONNECT_TIMEOUT"}),": Maximum number of seconds to wait when establishing a new database connection (default: 20)"]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"configure-cache-memory",children:"Configure cache memory"}),"\n",(0,t.jsx)(o.p,{children:"The default Langflow caching behavior is an asynchronous, in-memory cache."}),"\n",(0,t.jsx)(d.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"LANGFLOW_LANGCHAIN_CACHE=InMemoryCache",props:{}}]},{tokens:[{content:"LANGFLOW_CACHE_TYPE=Async",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,t.jsx)(o.p,{children:"Alternative caching options can be configured, but options other than the default asynchronous, in-memory cache are not supported.\nThe default behavior is suitable for most use cases."})]})}function f(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}function u(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},96841:(e,o,n)=>{n.d(o,{A:()=>r});const r=n.p+"assets/images/component-message-history-external-memory-7e32402d0b6e819f5539adfbfbd3620f.png"}}]);